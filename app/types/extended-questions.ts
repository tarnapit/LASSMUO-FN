// Additional question types for enhanced learning experience
import { BaseQuestion } from '../types/stage';

// Audio-based question (for pronunciation or sound identification)
export interface AudioQuestion extends BaseQuestion {
  type: "audio";
  audioUrl: string;
  answers: Array<{
    id: number;
    text: string;
    isCorrect: boolean;
    emoji?: string;
  }>;
}

// Image-based question (identify objects in images)
export interface ImageQuestion extends BaseQuestion {
  type: "image";
  imageUrl: string;
  hotspots?: Array<{
    id: string;
    x: number;
    y: number;
    width: number;
    height: number;
    isCorrect: boolean;
    label: string;
  }>;
  answers?: Array<{
    id: number;
    text: string;
    isCorrect: boolean;
    emoji?: string;
  }>;
}

// Sequence/Order question (arrange items in correct order)
export interface SequenceQuestion extends BaseQuestion {
  type: "sequence";
  items: Array<{
    id: string;
    text: string;
    emoji?: string;
    correctPosition: number;
  }>;
  instruction: string;
}

// Multiple select question (select all correct answers)
export interface MultipleSelectQuestion extends BaseQuestion {
  type: "multiple-select";
  answers: Array<{
    id: number;
    text: string;
    isCorrect: boolean;
    emoji?: string;
  }>;
  minCorrectAnswers: number;
  maxCorrectAnswers: number;
}

// Scale/Rating question (rate on a scale)
export interface ScaleQuestion extends BaseQuestion {
  type: "scale";
  scale: {
    min: number;
    max: number;
    step: number;
    labels: {
      min: string;
      max: string;
      middle?: string;
    };
  };
  correctRange: {
    min: number;
    max: number;
  };
}

// Categorization question (drag items into categories)
export interface CategorizationQuestion extends BaseQuestion {
  type: "categorization";
  categories: Array<{
    id: string;
    name: string;
    emoji?: string;
    color?: string;
  }>;
  items: Array<{
    id: string;
    text: string;
    emoji?: string;
    correctCategory: string;
  }>;
}

// Drawing/Sketch question (draw or mark on an image)
export interface DrawingQuestion extends BaseQuestion {
  type: "drawing";
  canvas: {
    backgroundImage?: string;
    width: number;
    height: number;
  };
  expectedDrawing?: {
    shapes: Array<{
      type: 'circle' | 'line' | 'arrow' | 'text';
      x: number;
      y: number;
      width?: number;
      height?: number;
      text?: string;
    }>;
  };
  allowedTools: Array<'pen' | 'eraser' | 'circle' | 'line' | 'arrow' | 'text'>;
}

// Simulation question (interactive simulation)
export interface SimulationQuestion extends BaseQuestion {
  type: "simulation";
  simulation: {
    type: 'solar-system' | 'planet-orbit' | 'moon-phases' | 'gravity';
    initialState: any;
    targetState: any;
    allowedActions: string[];
  };
  successCriteria: {
    tolerance: number;
    timeLimit?: number;
  };
}

// Extended question type union
export type ExtendedQuestion = 
  | AudioQuestion
  | ImageQuestion
  | SequenceQuestion
  | MultipleSelectQuestion
  | ScaleQuestion
  | CategorizationQuestion
  | DrawingQuestion
  | SimulationQuestion;

// Enhanced stage data with more question types
export interface EnhancedStageData {
  id: number;
  title: string;
  description: string;
  thumbnail: string;
  difficulty: 'easy' | 'medium' | 'hard';
  estimatedTime: string;
  prerequisites: number[];
  totalStars: number;
  xpReward?: number;
  streakBonus?: boolean;
  healthSystem?: boolean;
  character: {
    name: string;
    avatar: string;
    introduction: string;
    learningContent: string;
    completionMessage: string;
    encouragements?: string[];
    hints?: string[];
  };
  questions: ExtendedQuestion[];
  rewards: {
    stars: number;
    points: number;
    xp?: number;
    gems?: number;
    badges?: string[];
    unlocksStages?: number[];
    achievementUnlocks?: string[];
  };
  // Interactive elements
  interactiveElements?: {
    animations?: Array<{
      id: string;
      type: 'planet-rotation' | 'orbital-motion' | 'moon-phases' | 'comet-tail';
      triggerCondition: 'correct-answer' | 'stage-complete' | 'always';
    }>;
    soundEffects?: Array<{
      id: string;
      audioUrl: string;
      triggerCondition: 'correct-answer' | 'incorrect-answer' | 'stage-complete';
    }>;
    particleEffects?: Array<{
      id: string;
      type: 'stars' | 'sparkles' | 'rocket-trail' | 'explosion';
      triggerCondition: 'correct-answer' | 'perfect-score' | 'stage-complete';
    }>;
  };
}

// Sample enhanced questions for astronomy learning
export const enhancedQuestions: ExtendedQuestion[] = [
  {
    id: 1,
    type: "image",
    question: "‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏î‡∏≤‡∏ß‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ‡πÉ‡∏ô‡∏†‡∏≤‡∏û‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∏‡∏£‡∏¥‡∏¢‡∏∞",
    difficulty: 'easy',
    points: 15,
    timeLimit: 30,
    imageUrl: "/images/solar-system-diagram.jpg",
    hotspots: [
      {
        id: "jupiter",
        x: 350,
        y: 200,
        width: 60,
        height: 60,
        isCorrect: true,
        label: "‡∏î‡∏≤‡∏ß‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ"
      },
      {
        id: "saturn",
        x: 450,
        y: 200,
        width: 55,
        height: 55,
        isCorrect: false,
        label: "‡∏î‡∏≤‡∏ß‡πÄ‡∏™‡∏≤‡∏£‡πå"
      }
    ],
    explanation: "‡∏î‡∏≤‡∏ß‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ‡πÄ‡∏õ‡πá‡∏ô‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÅ‡∏•‡∏∞‡∏≠‡∏¢‡∏π‡πà‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà 5 ‡∏à‡∏≤‡∏Å‡∏î‡∏ß‡∏á‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå",
    funFact: "ü™ê ‡∏î‡∏≤‡∏ß‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ‡∏°‡∏µ‡∏°‡∏ß‡∏•‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î!"
  },
  {
    id: 2,
    type: "sequence",
    question: "‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏¥‡∏î‡∏î‡∏≤‡∏ß‡∏´‡∏≤‡∏á",
    difficulty: 'medium',
    points: 20,
    timeLimit: 45,
    instruction: "‡∏•‡∏≤‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏à‡∏≤‡∏Å 1 ‡∏ñ‡∏∂‡∏á 4",
    items: [
      {
        id: "approach",
        text: "‡∏î‡∏≤‡∏ß‡∏´‡∏≤‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏Å‡∏•‡πâ‡∏î‡∏ß‡∏á‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå",
        emoji: "‚òÑÔ∏è",
        correctPosition: 1
      },
      {
        id: "heat",
        text: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á‡∏£‡∏∞‡πÄ‡∏´‡∏¢",
        emoji: "üî•",
        correctPosition: 2
      },
      {
        id: "tail",
        text: "‡πÄ‡∏Å‡∏¥‡∏î‡∏´‡∏≤‡∏á‡∏î‡∏≤‡∏ß‡∏´‡∏≤‡∏á",
        emoji: "‚ú®",
        correctPosition: 3
      },
      {
        id: "visible",
        text: "‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡πÇ‡∏•‡∏Å",
        emoji: "üëÅÔ∏è",
        correctPosition: 4
      }
    ],
    explanation: "‡∏î‡∏≤‡∏ß‡∏´‡∏≤‡∏á‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏Å‡∏•‡πâ‡∏î‡∏ß‡∏á‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πä‡∏™‡∏£‡∏∞‡πÄ‡∏´‡∏¢‡∏≠‡∏≠‡∏Å‡∏°‡∏≤",
    funFact: "üåü ‡∏´‡∏≤‡∏á‡∏î‡∏≤‡∏ß‡∏´‡∏≤‡∏á‡∏°‡∏±‡∏Å‡∏à‡∏∞‡∏ä‡∏µ‡πâ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏î‡∏ß‡∏á‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå‡πÄ‡∏™‡∏°‡∏≠!"
  },
  {
    id: 3,
    type: "categorization",
    question: "‡∏à‡∏≥‡πÅ‡∏ô‡∏Å‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó",
    difficulty: 'medium',
    points: 25,
    timeLimit: 60,
    categories: [
      {
        id: "inner",
        name: "‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏†‡∏≤‡∏¢‡πÉ‡∏ô",
        emoji: "üåç",
        color: "#f59e0b"
      },
      {
        id: "outer",
        name: "‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å",
        emoji: "ü™ê",
        color: "#3b82f6"
      }
    ],
    items: [
      {
        id: "mercury",
        text: "‡∏î‡∏≤‡∏ß‡∏û‡∏∏‡∏ò",
        emoji: "‚òøÔ∏è",
        correctCategory: "inner"
      },
      {
        id: "venus",
        text: "‡∏î‡∏≤‡∏ß‡∏®‡∏∏‡∏Å‡∏£‡πå",
        emoji: "‚ôÄÔ∏è",
        correctCategory: "inner"
      },
      {
        id: "earth",
        text: "‡πÇ‡∏•‡∏Å",
        emoji: "üåç",
        correctCategory: "inner"
      },
      {
        id: "mars",
        text: "‡∏î‡∏≤‡∏ß‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£",
        emoji: "‚ôÇÔ∏è",
        correctCategory: "inner"
      },
      {
        id: "jupiter",
        text: "‡∏î‡∏≤‡∏ß‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ",
        emoji: "ü™ê",
        correctCategory: "outer"
      },
      {
        id: "saturn",
        text: "‡∏î‡∏≤‡∏ß‡πÄ‡∏™‡∏≤‡∏£‡πå",
        emoji: "ü™ê",
        correctCategory: "outer"
      },
      {
        id: "uranus",
        text: "‡∏î‡∏≤‡∏ß‡∏¢‡∏π‡πÄ‡∏£‡∏ô‡∏±‡∏™",
        emoji: "üåÄ",
        correctCategory: "outer"
      },
      {
        id: "neptune",
        text: "‡∏î‡∏≤‡∏ß‡πÄ‡∏ô‡∏õ‡∏à‡∏π‡∏ô",
        emoji: "üåä",
        correctCategory: "outer"
      }
    ],
    explanation: "‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏´‡∏¥‡∏ô ‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏Å‡πä‡∏™",
    funFact: "üî¨ ‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏´‡∏¥‡∏ô‡∏°‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏ú‡∏¥‡∏ß‡πÅ‡∏Ç‡πá‡∏á ‡∏™‡πà‡∏ß‡∏ô‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏Å‡πä‡∏™‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏Å‡πä‡∏™!"
  },
  {
    id: 4,
    type: "multiple-select",
    question: "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏î‡∏≤‡∏ß‡πÄ‡∏™‡∏≤‡∏£‡πå (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏Ç‡πâ‡∏≠)",
    difficulty: 'hard',
    points: 30,
    timeLimit: 40,
    minCorrectAnswers: 2,
    maxCorrectAnswers: 4,
    answers: [
      {
        id: 1,
        text: "‡∏°‡∏µ‡∏ß‡∏á‡πÅ‡∏´‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°",
        isCorrect: true,
        emoji: "üíç"
      },
      {
        id: 2,
        text: "‡πÄ‡∏õ‡πá‡∏ô‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏Å‡πä‡∏™",
        isCorrect: true,
        emoji: "üí®"
      },
      {
        id: 3,
        text: "‡∏°‡∏µ‡∏î‡∏≤‡∏ß‡πÄ‡∏ó‡∏µ‡∏¢‡∏°‡∏°‡∏≤‡∏Å‡∏°‡∏≤‡∏¢",
        isCorrect: true,
        emoji: "üåô"
      },
      {
        id: 4,
        text: "‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏Å‡∏•‡πâ‡∏î‡∏ß‡∏á‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î",
        isCorrect: false,
        emoji: "‚òÄÔ∏è"
      },
      {
        id: 5,
        text: "‡∏°‡∏µ‡∏™‡∏µ‡πÅ‡∏î‡∏á",
        isCorrect: false,
        emoji: "üî¥"
      },
      {
        id: 6,
        text: "‡πÄ‡∏õ‡πá‡∏ô‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 2",
        isCorrect: true,
        emoji: "ü•à"
      }
    ],
    explanation: "‡∏î‡∏≤‡∏ß‡πÄ‡∏™‡∏≤‡∏£‡πå‡∏°‡∏µ‡∏ß‡∏á‡πÅ‡∏´‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏° ‡πÄ‡∏õ‡πá‡∏ô‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏Å‡πä‡∏™ ‡∏°‡∏µ‡∏î‡∏≤‡∏ß‡πÄ‡∏ó‡∏µ‡∏¢‡∏°‡∏°‡∏≤‡∏Å‡∏°‡∏≤‡∏¢ ‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 2",
    funFact: "ü™ê ‡∏î‡∏≤‡∏ß‡πÄ‡∏™‡∏≤‡∏£‡πå‡πÄ‡∏ö‡∏≤‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡πâ‡∏≥ ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏™‡∏£‡∏∞‡∏ß‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠ ‡∏°‡∏±‡∏ô‡∏à‡∏∞‡∏•‡∏≠‡∏¢‡πÑ‡∏î‡πâ!"
  },
  {
    id: 5,
    type: "scale",
    question: "‡∏î‡∏ß‡∏á‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå‡∏£‡πâ‡∏≠‡∏ô‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏µ‡πà‡∏≠‡∏á‡∏®‡∏≤‡πÄ‡∏ã‡∏•‡πÄ‡∏ã‡∏µ‡∏¢‡∏™? (‡∏û‡∏∑‡πâ‡∏ô‡∏ú‡∏¥‡∏ß)",
    difficulty: 'hard',
    points: 25,
    timeLimit: 30,
    scale: {
      min: 1000,
      max: 10000,
      step: 500,
      labels: {
        min: "1,000¬∞C",
        max: "10,000¬∞C",
        middle: "5,500¬∞C"
      }
    },
    correctRange: {
      min: 5000,
      max: 6000
    },
    explanation: "‡∏û‡∏∑‡πâ‡∏ô‡∏ú‡∏¥‡∏ß‡∏î‡∏ß‡∏á‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå‡∏£‡πâ‡∏≠‡∏ô‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 5,500¬∞C ‡πÅ‡∏ï‡πà‡πÅ‡∏Å‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏£‡πâ‡∏≠‡∏ô‡∏ñ‡∏∂‡∏á 15 ‡∏•‡πâ‡∏≤‡∏ô‡∏≠‡∏á‡∏®‡∏≤!",
    funFact: "üå°Ô∏è ‡∏î‡∏ß‡∏á‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå‡∏£‡πâ‡∏≠‡∏ô‡∏°‡∏≤‡∏Å‡∏û‡∏≠‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏´‡∏•‡∏≠‡∏°‡πÇ‡∏•‡∏´‡∏∞‡∏ó‡∏∏‡∏Å‡∏ä‡∏ô‡∏¥‡∏î!"
  },
  {
    id: 6,
    type: "simulation",
    question: "‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÇ‡∏Ñ‡∏à‡∏£‡∏Ç‡∏≠‡∏á‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏£‡∏≠‡∏ö‡∏î‡∏ß‡∏á‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå",
    difficulty: 'hard',
    points: 35,
    timeLimit: 90,
    simulation: {
      type: 'planet-orbit',
      initialState: {
        planets: [
          { name: 'Earth', position: { x: 0, y: 0 }, velocity: { x: 0, y: 0 } }
        ],
        sun: { position: { x: 0, y: 0 } }
      },
      targetState: {
        planets: [
          { name: 'Earth', orbitCompleted: true }
        ]
      },
      allowedActions: ['adjust-velocity', 'adjust-position']
    },
    successCriteria: {
      tolerance: 0.1,
      timeLimit: 60
    },
    explanation: "‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡∏à‡∏£‡∏£‡∏≠‡∏ö‡∏î‡∏ß‡∏á‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå‡∏î‡πâ‡∏ß‡∏¢‡πÅ‡∏£‡∏á‡πÇ‡∏ô‡πâ‡∏°‡∏ñ‡πà‡∏ß‡∏á ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÅ‡∏•‡∏∞‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏°‡∏î‡∏∏‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏Ñ‡∏à‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏á‡∏Å‡∏•‡∏°",
    funFact: "üåç ‡πÇ‡∏•‡∏Å‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏£‡∏≠‡∏ö‡∏î‡∏ß‡∏á‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß 30 ‡∏Å‡∏¥‡πÇ‡∏•‡πÄ‡∏°‡∏ï‡∏£‡∏ï‡πà‡∏≠‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ!"
  }
];

// Question validation functions
export const validateExtendedQuestion = (question: ExtendedQuestion): boolean => {
  const baseValidation = question.id > 0 && 
                        question.question.length > 0 && 
                        question.points > 0;
  
  if (!baseValidation) return false;
  
  switch (question.type) {
    case 'audio':
      return Boolean(question.audioUrl) && question.answers.length > 0;
    
    case 'image':
      const hasValidImageUrl = Boolean(question.imageUrl && question.imageUrl.length > 0);
      const hasValidContent = Boolean(
        (question.hotspots && question.hotspots.length > 0) ||
        (question.answers && question.answers.length > 0)
      );
      return hasValidImageUrl && hasValidContent;
    
    case 'sequence':
      return question.items.length > 1 && 
             question.items.every(item => item.correctPosition > 0);
    
    case 'multiple-select':
      return question.answers.length > 0 && 
             question.answers.some(a => a.isCorrect) &&
             question.minCorrectAnswers > 0 &&
             question.maxCorrectAnswers <= question.answers.filter(a => a.isCorrect).length;
    
    case 'scale':
      return question.scale.min < question.scale.max &&
             question.correctRange.min >= question.scale.min &&
             question.correctRange.max <= question.scale.max;
    
    case 'categorization':
      return question.categories.length > 0 &&
             question.items.length > 0 &&
             question.items.every(item => 
               question.categories.some(cat => cat.id === item.correctCategory)
             );
    
    case 'drawing':
      return Boolean(question.canvas) && question.allowedTools.length > 0;
    
    case 'simulation':
      return Boolean(question.simulation.type) &&
             Boolean(question.simulation.initialState) &&
             Boolean(question.simulation.targetState);
    
    default:
      return true;
  }
};

// Question type specific scoring
export const calculateQuestionScore = (question: ExtendedQuestion, userAnswer: any, timeSpent: number): number => {
  let baseScore = question.points;
  
  // Time bonus for quick answers
  if (question.timeLimit && timeSpent < question.timeLimit * 0.5) {
    baseScore *= 1.2;
  }
  
  // Complexity bonus for harder question types
  const complexityMultiplier: Record<ExtendedQuestion['type'], number> = {
    'audio': 1.1,
    'image': 1.2,
    'sequence': 1.3,
    'multiple-select': 1.4,
    'scale': 1.1,
    'categorization': 1.5,
    'drawing': 1.6,
    'simulation': 2.0
  };
  
  baseScore *= complexityMultiplier[question.type] || 1.0;
  
  return Math.round(baseScore);
};
